rm(list=ls())
setwd('/home/guoqiang/Documents/bioinfo/CPGEA/LuXin_6176/')
ls()
# import datasets
df.norm = read.csv('FOXA1_normal_expr_log2FPKM.csv', header = T, stringsAsFactors = F, check.names = F)
View(df.norm)
df.muta = read.csv('FOXA1_mutation_expr_log2FPKM.csv', header = T, stringsAsFactors = F, check.names = F)
View(df.muta)
# dissect matrix
df.norm.mtx = df.norm(,-c(1:2))
# dissect matrix
df.norm.mtx = df.norm[,-c(1:2)]
View(df.norm.mtx)
# dissect matrix
df.norm.mtx = as.matrix(df.norm[,-c(1:2)])
df.muta.mtx = as.matrix(df.muta[,-c(1:2)])
# apply transformation on matrix
df.norm.tfm = apply(df.norm.mtx, 2, fpkmToTpm)
# define function for transformation
fpkmToTpm <- function(fpkm) {
exp(log(fpkm) - log(sum(fpkm)) + log(1e6))
}
# apply transformation on matrix
df.norm.tfm = apply(df.norm.mtx, 2, fpkmToTpm)
View(df.norm.tfm)
# apply transformation on matrix
df.norm.tfm = apply(df.norm.mtx, 2, fpkmToTpm)
df.muta.tfm = apply(df.muta.mtx, 2, fpkmToTpm)
# integrate transformation and save
df.norm.tpm = data.frame(df.norm[,c(1,2)], df.norm.tfm)
View(df.norm.tpm)
# integrate transformation and save
df.norm.tpm = data.frame(df.norm[,c(1,2)], df.norm.tfm)
df.muta.tpm = data.frame(df.muta[,c(1,2)], df.muta.tfm)
write.csv(df.norm.tpm, file = '/FOXA1_normal_expr_TPM.csv')
write.csv(df.norm.tpm, file = 'FOXA1_normal_expr_TPM.csv')
write.csv(df.norm.tpm, file = 'FOXA1_normal_expr_TPM.csv', row.names = F)
write.csv(df.muta.tpm, file = 'FOXA1_mutation_expr_TPM.csv', row.names = F)
