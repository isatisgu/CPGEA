q()
library(dplyr)
q()
rm(list=ls())
# set work dir
setwd('/afs/crc.nd.edu/user/y/ygu8/project/CPGEA/LuXin_6176')
# import datasets
df.norm = read.csv('FOXA1_normal_expr_log2FPKM.csv', header = T, stringsAsFactors = F, check.names = F)
df.muta = read.csv('FOXA1_mutation_expr_log2FPKM.csv', header = T, stringsAsFactors = F, check.names = F)
# dissect matrix
df.norm.mtx = as.matrix(df.norm[,-c(1:2)])
df.muta.mtx = as.matrix(df.muta[,-c(1:2)])
head(df.norm.mtx[,6])
head(df.norm.mtx[,1:6])
head(df.norm.mtx[,1:5])
head(df.norm[,1:6])
# apply transformation on matrix
df.norm.tfm = apply(df.norm.mtx, 2, fpkmToTpm)
df.muta.tfm = apply(df.muta.mtx, 2, fpkmToTpm)
# define function for transformation
fpkmToTpm <- function(fpkm) {
  (2^fpkm) * 1e6 / sum(2^fpkm)
}
# apply transformation on matrix
df.norm.tfm = apply(df.norm.mtx, 2, fpkmToTpm)
df.muta.tfm = apply(df.muta.mtx, 2, fpkmToTpm)
# integrate transformation and save
df.norm.tpm = data.frame(df.norm[,c(1,2)], df.norm.tfm)
df.muta.tpm = data.frame(df.muta[,c(1,2)], df.muta.tfm)
write.csv(df.norm.tpm, file = 'FOXA1_normal_expr_TPM.csv', row.names = F)
write.csv(df.muta.tpm, file = 'FOXA1_mutation_expr_TPM.csv', row.names = F)
head(df.norm.tpm[,1:5])
q(_
q()
